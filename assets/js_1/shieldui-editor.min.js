/* Shield UI 1.7.43 | Copyright 2013-2021 Shield UI Ltd. | http://www.shieldui.com/eula */
!function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o=b.ui.Widget,p=b.Class,q=(b.Constants.KeyCode,document),r=a.proxy,s=(a.each,a.extend),t=(a.map,a.contains),u=(a.trim,b.error,b.guid),v=b.format,w=b.is.defined,x=(b.is["boolean"],b.is.integer,b.is.func),y=(b.is.array,b.is.object,b.is.string),z=b.to.string,A=b.to["int"],B=b.support.browser,C="disabled",D="focus",E="blur",F="click",G="keyup",H="keydown",I="formatting",J="text-formatting",K="font-and-colors",L="alignment",M="lists",N="links",O="sui-editor",P="styleWithCSS",Q=function(){},R=function(a,b,c,d){if(d)try{a.execCommand(b,!1,c)}catch(e){Q("execCommand({0}, {1}) error: {3}",b,c,e)}else a.execCommand(b,!1,c)};e=function(b,c){var d,e,f,g;!b.getSelection&&c.selection&&(d=null,b.getSelection=function(){return null!=d?d:d=new f},c.createRange=function(){return new e},c.attachEvent("onkeydown",function(){return b.getSelection().setRangeAt(0,new e((!0)))}),c.attachEvent("onselectionchange",function(){var a,d,f;try{d=new e((!0))}catch(g){}if(d)return b.getSelection().setRangeAt(0,d),a=c.selection.createRange().parentElement(),"INPUT"===a.tagName||"TEXTAREA"===a.tagName?(f=b.getSelection().getRangeAt(0),a.selectionStart=f.selectionStart,a.selectionEnd=f.selectionEnd,a.selectionEnd):void 0}),e=b.Range=function(){var b=function(a){var b=this;a?b.range=c.selection.createRange():(b.range=c.body.createTextRange(),b.collapse(!0)),b.init()};return b.END_TO_END="EndToEnd",b.END_TO_START="EndToStart",b.START_TO_END="StartToEnd",b.START_TO_START="StartToStart",b.prototype.init=function(){var a,b,c,d,e,f,h=this;return b=h.range.parentElement(),h.commonAncestorContainer=b,h.collapsed=0===h.compareBoundaryPoints("StartToEnd",h),f=h.range.duplicate(),f.moveToElementText(b),a=h.range.text.length>0?0:1,e=g.findLength("StartToStart",f,h.range),c=g.findNodeByPos(b,e,a),h.startContainer=c.el,h.startOffset=c.offset,d=g.findLength("StartToEnd",f,h.range),c=g.findNodeByPos(b,d,1),h.endContainer=c.el,h.endOffset=c.offset,h.selectionStart=g.findLength("StartToStart",f,h.range,h),h.selectionEnd=g.findLength("StartToEnd",f,h.range,h),h.selectionEnd},b.prototype.select=function(){return this.range.select()},b.prototype.setStart=function(a,b){var c,d,e=this;if(g.getText(a).length>=b&&b>=0)return d=e.range.duplicate(),3===a.nodeType&&(c=g.findPosFromNode(a),d.moveToElementText(a.parentNode),d.moveStart("character",c+b)),e.range.compareEndPoints("StartToEnd",d)===-1&&e.range.setEndPoint("EndToStart",d),e.range.setEndPoint("StartToStart",d)},b.prototype.setEnd=function(a,b){var c,d,e=this;if(g.getText(a).length>=b&&b>=0)return d=e.range.duplicate(),3===a.nodeType&&(c=g.findPosFromNode(a),d.moveToElementText(a.parentNode),d.moveStart("character",c+b)),e.range.setEndPoint("EndToStart",d)},b.prototype.selectNodeContents=function(a){return this.range.moveToElementText(a)},b.prototype.collapse=function(a){var b=this;return a?b.range.setEndPoint("EndToStart",b.range):b.range.setEndPoint("StartToEnd",b.range)},b.prototype.deleteContents=function(){},b.prototype.insertNode=function(b){var d=b.outerHTML?b.outerHTML:a(c.createElement("div")).append(a(b).clone()).html();this.range.pasteHTML(d)},b.prototype.compareBoundaryPoints=function(a,b){return this.range.compareEndPoints(a,b.range)},b.prototype.cloneRange=function(){var a=new b;return a.range=this.range.duplicate(),a.init(),a},b.prototype.detach=function(){return delete this.range},b.prototype.getBoundingClientRect=function(){var a=this.range.getBoundingClientRect();return{width:a.right-a.left,height:a.bottom-a.top,left:a.left,right:a.right,bottom:a.bottom,top:a.top}},b.prototype.toString=function(){return this.range.text||""},b}(),f=function(){var a=function(){this.selection=c.selection,this.ranges=[],this.init()};return a.prototype.init=function(){var a,b,c,d,f,g=this;if(g.rangeCount=g.ranges.length,g.rangeCount)return b=g.ranges[0],null==g.prev&&(g.prev=b),0===b.compareBoundaryPoints(e.END_TO_END,g.prev)?(d=["end","start"],a=d[0],c=d[1]):(f=["start","end"],a=f[0],c=f[1]),g.anchorNode=b[""+a+"Container"],g.anchorOffset=b[""+a+"Offset"],g.focusNode=b[""+c+"Container"],g.focusOffset=b[""+c+"Offset"],g.isCollapsed=g.anchorNode===g.focusNode,g.isCollapsed},a.prototype.getRangeAt=function(a){return this.ranges[a]},a.prototype.setRangeAt=function(a,b){var c=this;return c.prev=c.ranges[a],c.ranges[a]=b,c.init()},a.prototype.removeAllRanges=function(){return this.ranges=[],this.init()},a.prototype.addRange=function(a){var b,c,d,e,f,g=this;for(g.ranges.push(a),g.init(),e=g.ranges,f=[],c=0,d=e.length;c<d;c++)b=e[c],f.push(b.select());return f},a.prototype.deleteFromDocument=function(){return this.selection.clear()},a.prototype.toString=function(){return this.ranges[0].toString()},a}(),g={convertLineBreaks:function(a){return a.replace(/\r\n/g,"\n")},stripLineBreaks:function(a){return a.replace(/\r\n/g,"")},getText:function(a){return a.innerText||a.nodeValue},findLength:function(a,b,c,d){var e=b.duplicate();switch(a){case"StartToStart":e.setEndPoint("EndToStart",c);break;case"StartToEnd":e.setEndPoint("EndToEnd",c)}return d?g.convertLineBreaks(e.text).length:g.stripLineBreaks(e.text).length},findNodeByPos:function(a,b,c){var d,e;return null==c&&(c=0),e={length:0,el:a,offset:0},d=function(a,b,c,e){var f,g,h,i,j;for(i=a.childNodes,j=[],g=0,h=i.length;g<h;g++)if(f=i[g],!e.found)if(3===f.nodeType){if(e.length+f.length+c>b){e.found=!0,e.el=f,e.offset=b-e.length;break}j.push(e.length+=f.length)}else j.push(d(f,b,c,e));return j},d(a,b,c,e),e},findPosFromNode:function(a){var b,c,d;return c={pos:0},d=a.parentNode,b=function(a,c,d){var e,f,g,h,i;for(h=a.childNodes,i=[],f=0,g=h.length;f<g;f++)if(e=h[f],!d.found){if(e===c){d.found=!0;break}3===e.nodeType?i.push(d.pos+=e.length):e.hasChildNodes()?i.push(b(e,c,d)):i.push(void 0)}return i},b(d,a,c),c.pos}})},f=p.extend({init:function(a,b){var c=this;c._editor=a,y(b)?l[b]?(c.options=s(!0,{},l[b]),c._default=!0):c.options={name:b}:c.options=s(!0,{},b)},_renderButton:function(b){var c=this,d=c._editor,e=c.options,f=e.name,g=e.tooltip||d.options.messages[f]||"",h=e.cls||(c._default?"sui-editor-toolbar-icon sui-editor-toolbar-icon-"+f.toLowerCase():""),i=s(!0,{cls:"sui-editor-toolbar-item sui-editor-toolbar-button",events:{click:function(a){c.execute(a)}}},e.controlOptions);c._widget=a('<button type="button" title="'+g+'"/>').append(e.text?e.text:"<span"+(h?' class="'+h+'"':"")+">&nbsp;</span>").appendTo(b).shieldButton(i).swidget()},render:function(b){var c,d=this,e=d.options,f=e.template;w(f)?(c=v.call(d._editor,f,e),c&&a(c).appendTo(b)):d._renderButton(b)},execute:function(a){var b=this,c=b.options,d=c.exec,e=b._editor,f=function(){e._afterCommand(a,c,b.getState())};x(d)?d.call(e,c,f):b.executeCommand(f)},executeCommand:function(a){var b=this,c=b.options,d=c.styleWithCSS,e=b._editor,f=e.getDoc();e.focus(!0),d&&R(f,P,!0,!0),R(f,c.name,b.getValue()),d&&R(f,P,!1,!0),x(a)&&a.call(b)},getValue:function(){},setValue:function(a){},getState:function(){var a,b,c,d,e=this,f=e.options,g=f.name,h=f.styleWithCSS,i=e._editor,j=i.getDoc(),k=!0;h&&R(j,P,!0,!0);try{k=j.queryCommandIndeterm(g)}catch(l){Q("queryCommandIndeterm({0}) error: {1}",g,l)}try{a=j.queryCommandEnabled(g)}catch(l){Q("queryCommandEnabled({0}) error: {1}",g,l)}if(!k)try{b=j.queryCommandState(g)}catch(l){Q("queryCommandState({0}) error: {1}",g,l)}try{c=j.queryCommandSupported(g)}catch(l){Q("queryCommandSupported({0}) error: {1}",g,l)}try{d=j.queryCommandValue(g)}catch(l){Q("queryCommandValue({0}) error: {1}",g,l)}return h&&R(j,P,!1,!0),{enabled:a,state:b,supported:c,value:d}},getWidget:function(){return this._widget},refresh:function(){var a,b=this,c=b._widget;b._default&&(a=b.getState(),a.enabled?(c.visible(!0),b.setValue(a)):c.visible(!1))},destroy:function(){var a=this;a._widget&&x(a._widget.destroy)&&a._widget.destroy(),a._default=a._widget=d}}),f.getInstance=function(a,b){var c="";return y(b)?l[b]&&(c=l[b].controlType):c=b.controlType,c||(c=f),new c(a,b)},b.ui.EditorCommand=f,g=f.extend({}),b.ui.EditorCommand=f,h=g.extend({init:function(a,b){g.fn.init.call(this,a,b),s(!0,this.options,{controlOptions:{toggle:!0}})},getValue:function(){return!!this._widget.checked()},setValue:function(a){this._widget.checked(!!a.state)}}),b.ui.EditorCommandToggleButton=h,j=f.extend({render:function(b){var c=this,d=c._editor,e=c.options,f=e.tooltip||d.options.messages[e.name]||"",g=s(!0,{cls:"sui-editor-toolbar-item sui-editor-toolbar-select",events:{itemclick:function(a){c.execute(a)}}},e.controlOptions);c._widget=a('<select title="'+f+'"/>').appendTo(b).shieldComboBox(g).swidget()},getValue:function(){return this._widget.value()},setValue:function(a){this._widget.value(a.value)}}),b.ui.EditorCommandComboBox=j,i=j.extend({init:function(a,b){j.fn.init.call(this,a,b),s(!0,this.options,{controlOptions:{editable:!1}})}}),b.ui.EditorCommandDropDown=i,k=f.extend({render:function(b){var c=this,d=c._editor,e=c.options,f=e.tooltip||d.options.messages[e.name]||"",g=s(!0,{cls:"sui-editor-toolbar-item sui-editor-toolbar-colorpicker",events:{select:function(a){this.hidePalette(),c.execute(a),setTimeout(function(){d.focus()})}}},e.controlOptions);c._widget=a('<input type="color" title="'+f+'"/>').appendTo(b).shieldColorPicker(g).swidget()},getValue:function(){return this._widget.value().hex()},setValue:function(a){this._widget.value(a.value)}}),b.ui.EditorCommandColorPicker=k,l={formatBlock:{name:"formatBlock",group:I,controlType:i,controlOptions:{valueTemplate:"{value}",textTemplate:"{text}",dataSource:{data:[{text:"Paragraph",value:"p"},{text:"Quotation",value:"blockquote"},{text:"Heading 1",value:"h1"},{text:"Heading 2",value:"h2"},{text:"Heading 3",value:"h3"},{text:"Heading 4",value:"h4"},{text:"Heading 5",value:"h5"},{text:"Heading 6",value:"h6"}]}}},removeFormat:{name:"removeFormat",group:I,controlType:g},fontName:{name:"fontName",group:K,styleWithCSS:!0,controlType:i.extend({setValue:function(a){var b,c=this._widget,d=a.value;if(c.value(d),c.selected()<0)for(b=0;b<c.dataSource.view.length;b++)if(c.dataSource.view[b].text==d){c.selected(b);break}c.selected()<0&&c.selected(0)}}),controlOptions:{valueTemplate:"{value}",textTemplate:"{text}",value:"",dataSource:{data:[{text:"Inherited",value:""},{text:"Arial",value:"Arial,Helvetica,sans-serif"},{text:"Courier New",value:'"Courier New",Courier,monospace'},{text:"Georgia",value:"Georgia,serif"},{text:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{text:"Times New Roman",value:'"Times New Roman",Times,serif'},{text:"Verdana",value:"Verdana,Geneva,sans-serif"}]}}},fontSize:{name:"fontSize",group:K,controlType:i.extend({setValue:function(a){this._widget.value(z(a.value)||"")}}),controlOptions:{valueTemplate:"{value}",textTemplate:"{text}",value:"inherit",dataSource:{data:[{text:"Inherited",value:""},{text:"1 (8pt)",value:"1"},{text:"2 (10pt)",value:"2"},{text:"3 (12pt)",value:"3"},{text:"4 (14pt)",value:"4"},{text:"5 (18pt)",value:"5"},{text:"6 (24pt)",value:"6"},{text:"7 (36pt)",value:"7"}]}}},foreColor:{name:"foreColor",group:K,controlType:k,controlOptions:{value:"transparent",palette:"basic",showLetter:!0}},backColor:{name:"backColor",group:K,styleWithCSS:!0,controlType:k,controlOptions:{value:"transparent",palette:"basic"}},bold:{name:"bold",group:J,controlType:h},italic:{name:"italic",group:J,controlType:h},underline:{name:"underline",group:J,controlType:h},strikeThrough:{name:"strikeThrough",group:J,controlType:h},subscript:{name:"subscript",group:J,controlType:h},superscript:{name:"superscript",group:J,controlType:h},justifyLeft:{name:"justifyLeft",group:L,controlType:h.extend({setValue:function(a){this._widget.checked(!!(B.ie?a.value:a.state))}})},justifyCenter:{name:"justifyCenter",group:L,controlType:h.extend({setValue:function(a){this._widget.checked(!!(B.ie?a.value:a.state))}})},justifyRight:{name:"justifyRight",group:L,controlType:h.extend({setValue:function(a){this._widget.checked(!!(B.ie?a.value:a.state))}})},justifyFull:{name:"justifyFull",group:L,controlType:h.extend({setValue:function(a){this._widget.checked(!!(B.ie?a.value:a.state))}})},insertUnorderedList:{name:"insertUnorderedList",group:M,controlType:g},insertOrderedList:{name:"insertOrderedList",group:M,controlType:g},indent:{name:"indent",group:M,controlType:g},outdent:{name:"outdent",group:M,controlType:g},createLink:{name:"createLink",group:N,controlType:g.extend({executeCommand:function(c){var d,e=this,f=e._editor,g=u();d=new b.ui.Window(a('<div id="'+g+'"/>'),{cls:"sui-editor-dialog sui-editor-dialog-insertimage",title:"Insert Hyperlink",titleBarButtons:["close"],modal:!0,height:220,content:{template:{body:function(){return[a('<div style="padding:5px; margin-top:10px;"/>').append(a("<label>URL</label>"),a('<input type="text" value="http://" id="url_'+g+'" class="sui-input" style="width:220px;"/>')),a('<div style="padding:5px;"/>').append(a("<label>Tooltip</label>"),a('<input type="text" value="" id="title_'+g+'" class="sui-input" style="width:220px;"/>')),a('<div style="padding:5px;"/>').append(a("<label>New window</label>"),a('<input type="checkbox" id="newwin_'+g+'"/>')),a('<div class="sui-editor-dialog-buttons"/>').append(new b.ui.Button(a("<button>Insert</button>"),{events:{click:function(){f.focus(!0),R(f.getDoc(),"createLink",g);var b=a(f.element).find('a[href="'+g+'"]'),h=a("#url_"+g).val(),i=(a("#text_"+g).val(),a("#title_"+g).val()),j=a("#newwin_"+g).swidget().checked();a(b).attr("href",h),i&&a(b).attr("title",i),j&&a(b).attr("target","_blank"),d.close(),a("#"+g).remove(),x(c)&&c.call(e)}}}).element,new b.ui.Button(a("<button>Cancel</button>"),{events:{click:function(){d.close(),a("#"+g).remove(),x(c)&&c.call(e)}}}).element)]}}},appendToBody:!0,events:{close:function(){a("#"+g).remove(),x(c)&&c.call(e)}}}),a("#newwin_"+g).shieldCheckBox()}})},unlink:{name:"unlink",group:N,controlType:g},insertImage:{name:"insertImage",group:"insert-img",controlType:h.extend({_getSelectedImg:function(){var b=this,c=b._editor.getSelection(),d=c&&"Range"==c.type?c.anchorNode:null,e=null!=d&&a(d).length>0?(a(d).prop("tagName")+"").toLowerCase():null,f=null;return"img"==e?f=d:"p"==e||"div"==e?(f=a(d).children("img").first(),f.length<=0&&(f=null)):"body"==e&&(f=a(d).find("img").first(),f.length<=0&&(f=null)),f},getState:function(){var a=this,b=a._getSelectedImg(),c=h.fn.getState.call(a);return b&&(c.state=!0),c},executeCommand:function(c){var d,e=this,f=e._editor,g=e._getSelectedImg(),h=u();d=new b.ui.Window(a('<div id="'+h+'"/>'),{cls:"sui-editor-dialog sui-editor-dialog-insertimage",title:"Insert Image",titleBarButtons:["close"],modal:!0,height:260,content:{template:{body:function(){var i="http://",j="",k="",l="";return g&&a(g).length>0&&(i=a(g).attr("src"),j=a(g).attr("alt"),a(g).attr("width")?k=+a(g).attr("width"):(k=a(g).get(0).style&&a(g).get(0).style.width?a(g).get(0).style.width+"":a(g).css("width")+"",/px/i.test(k)&&(k=A(k))),a(g).attr("height")?l=+a(g).attr("height"):(l=a(g).get(0).style&&a(g).get(0).style.height?a(g).get(0).style.height+"":a(g).css("height")+"",/px/i.test(l)&&(l=A(l)))),[a('<div style="padding:5px; margin-top:10px;"/>').append(a("<label>URL</label>"),a('<input type="text" value="'+i+'" id="url_'+h+'" class="sui-input" style="width:220px;"/>')),a('<div style="padding:5px;"/>').append(a("<label>Alternate text</label>"),a('<input type="text" value="'+j+'" id="alt_'+h+'" class="sui-input" style="width:220px;"/>')),a('<div style="padding:5px;"/>').append(a("<label>Width</label>"),a('<input type="text" value="'+k+'" id="width_'+h+'" class="sui-input" style="width:80px;"/>')),a('<div style="padding:5px;"/>').append(a("<label>Height</label>"),a('<input type="text" value="'+l+'" id="height_'+h+'" class="sui-input" style="width:80px;"/>')),a('<div class="sui-editor-dialog-buttons"/>').append(new b.ui.Button(a("<button>Insert</button>"),{events:{click:function(){var b=a("#alt_"+h).val(),g=a("#width_"+h).val(),i=a("#height_"+h).val(),j='<img src="'+a("#url_"+h).val()+'"'+(b?' alt="'+b+'"':""),k="";/[a-zA-Z]/.test(g)?k+=" width:"+g+";":g&&(j+=' width="'+g+'"'),/[a-zA-Z]/.test(i)?k+=" height:"+i+";":i&&(j+=' height="'+i+'"'),j+=(k?' style="'+k+'"':"")+" />",f.paste(j),d.close(),a("#"+h).remove(),x(c)&&c.call(e)}}}).element,new b.ui.Button(a("<button>Cancel</button>"),{events:{click:function(){d.close(),a("#"+h).remove(),x(c)&&c.call(e)}}}).element)]}}},appendToBody:!0,events:{close:function(){a("#"+h).remove(),x(c)&&c.call(e)}}})}})},viewHtml:{name:"viewHtml",group:"view-html",controlType:g.extend({refresh:function(){},executeCommand:function(c){var d,e,f=this,g=f._editor,h=u();e=function(){a("#"+h+" textarea").outerHeight(a("#"+h+" .sui-window-content").innerHeight()-a("#"+h+" .sui-editor-dialog-buttons").outerHeight()-10)},d=new b.ui.Window(a('<div id="'+h+'"/>'),{cls:"sui-editor-dialog sui-editor-dialog-viewhtml",title:"View HTML",titleBarButtons:["close"],modal:!0,resizable:{events:{resize:e}},content:{template:{body:function(){return[a("<div/>").append(a('<textarea class="sui-input"/>').val(g.value())),a('<div class="sui-editor-dialog-buttons"/>').append(new b.ui.Button(a("<button>Update</button>"),{events:{click:function(){g.value(a("#"+h+" textarea").val()),d.close(),a("#"+h).remove(),x(c)&&c.call(f)}}}).element,new b.ui.Button(a("<button>Cancel</button>"),{events:{click:function(){d.close(),a("#"+h).remove(),x(c)&&c.call(f)}}}).element)]}}},appendToBody:!0,events:{close:function(){a("#"+h).remove(),x(c)&&c.call(f)}}}),e()}})}},m={cls:d,enabled:!0,domain:d,height:d,commands:["formatBlock","bold","italic","underline","justifyLeft","justifyCenter","justifyRight","insertUnorderedList","insertOrderedList","createLink","unlink","insertImage"],messages:{formatBlock:"Format",removeFormat:"Remove formatting",fontName:"Font family",fontSize:"Font size",foreColor:"Font color",backColor:"Text highlight color",bold:"Bold",italic:"Italic",underline:"Underline",strikeThrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyLeft:"Align text left",justifyCenter:"Center text",justifyRight:"Align text right",justifyFull:"Justify",insertUnorderedList:"Insert unordered list",insertOrderedList:"Insert ordered list",indent:"Add indentation",outdent:"Remove indentation",createLink:"Insert hyperlink",unlink:"Remove hyperlink",insertImage:"Insert image",viewHtml:"View HTML"},events:{}},n=o.extend({init:function(){o.fn.init.apply(this,arguments),w(this.initialOptions.commands)&&(this.options.commands=this.initialOptions.commands);var b,c,d,f,g=this,h=a(g.element),i=g.options,j=(i.dieOnError,i.cls),k=i.height;g._original=b=a(g.element),g._tagname=c=b.prop("tagName").toLowerCase(),f=g._eventNS=".shieldEditor"+g.getInstanceId(),"textarea"==c?(g._inline=!1,g._wrapper=b.wrap('<div class="'+O+" "+O+"-default"+(j?" "+j:"")+'"/>').parent(),b.hide(),g._iframe=d=a('<iframe class="sui-editor-iframe" frameborder="0"'+(w(k)?' height="'+k+'"':"")+"/>").appendTo(g._wrapper),g.value(b.val(),!0),g.element=h=d.contents().find("body")):(g._inline=!0,h.addClass(O+" "+O+"-inline"+(j?" "+j:"")).attr("autocorrect","off").prop("contentEditable","true")),g._initEvents(),e(g.getWin(),g.getDoc()),g._initToolbar(),a(q).on(F+f,r(g._docClick,g)),g.enabled(i.enabled)},refresh:function(a){this.refreshWithElement(this._original,a)},_isInside:function(b){var c=this,d=a(c.element),e=a(c._toolbar);return d.get(0)===b||e.get(0)===b||t(d.get(0),b)||t(e.get(0),b)},_saveSelections:function(){var a,b,c=this;if(!c._inline&&(c._savedSelections=[],a=c.getSelection(),a.rangeCount))for(b=0;b<a.rangeCount;b++)c._savedSelections.push(a.getRangeAt(b))},_restoreSelections:function(){var a,b,c=this;if(!c._inline){if(c._savedSelections&&c._savedSelections.length>0)for(a=c.getSelection(),a.removeAllRanges(),b=0;b<c._savedSelections.length;b++)a.addRange(c._savedSelections[b]);c._savedSelections=[]}},_focus:function(c){var d=this,e=a(d.element),f=a(d._toolbar);d._inline&&(f.show(),e.addClass("sui-editor-inline-focus"),d._toolbarMoved||(f.outerWidth(e.outerWidth()),b.ui.Position.Set(f,e,{source:"left bottom",target:"left top"}))),d._restoreSelections(),d.refreshCommands()},_blur:function(a){this._saveSelections(),this._syncValue()},_click:function(a){this.refreshCommands(),this._syncValue()},_docClick:function(a){var b=this;b._inline&&!b._isInside(a.target)&&b._hideToolbar()},_keydown:function(a){this.trigger(H,{domEvent:a})},_keyup:function(a){var b=this;b.refreshCommands(),b._syncValue(),b.trigger(G,{domEvent:a})},_syncValue:function(){var b,c=this,d=[].slice.call(arguments);c._inline||(b=d.length>0?d[0]:a(c.getDoc().body).html(),a(c._original).val(b))},_hideToolbar:function(){this._toolbar.hide(),this.element.removeClass("sui-editor-inline-focus")},_initToolbar:function(){var b,c,d,e,g,h,i,j=this,k=j.options,l=k.commands,m=j._inline,n=[],o=[],p={};for(j._toolbar=b=a('<div class="sui-editor-toolbar"/>'),m?(b.addClass("sui-editor-toolbar-inline").appendTo(q.body),b.shieldDraggable().swidget().one("drag",function(){j._toolbarMoved=!0}),j._toolbarMoved=!1):b.prependTo(j._wrapper),i=0;i<l.length;i++)n.push(f.getInstance(j,l[i]));for(i=0;i<n.length;i++)p[n[i].options.group]||(p[n[i].options.group]=[],o.push(n[i].options.group)),p[n[i].options.group].push(n[i]);for(j._commands=[],i=0;i<o.length;i++){d=o[i];for(var r=0;r<p[d].length;r++)c=p[d][r],h=d&&e===d?g:a('<div class="sui-editor-toolbar-group"/>').appendTo(b),c.render(h),j._commands.push(c),e=d,g=h}m&&b.hide()},_afterCommand:function(a,b,c){var d=this;d._syncValue(),d.refreshCommands(),d.trigger("execute",{domEvent:a,commandName:b.name,state:c})},refreshCommands:function(){var a,b=this,c=b._commands||[];if(!b._refreshInProgress){for(b.focus(!0),b._refreshInProgress=!0,a=0;a<c.length;a++)c[a].refresh();b._refreshInProgress=!1}},_getWrapper:function(){return this._inline?this.element:this._wrapper},getWin:function(){var b,d=this;return d._inline?c:(b=a(d._iframe).get(0),b.contentWindow||b.contentDocument)},getDoc:function(){var b,c=this;return c._inline?q:(b=a(c._iframe).get(0),(b.contentWindow||b.contentDocument).document)},focus:function(b){var c,d=this;b&&!d._refreshInProgress&&(d._refreshInProgress=!0,c=!0),a(d._inline?d.element:d.getDoc().body).focus(),!d._inline&&B.ie&&d._focus(),c&&(d._refreshInProgress=!1)},execute:function(a,b){R(this.getDoc(),a,b)},createRange:function(){return this.getDoc().createRange()},getRange:function(){return this.focus(!0),this.getSelection().getRangeAt(0)},getSelection:function(){return this.getWin().getSelection()},selectRange:function(a){var b=this,c=b.getSelection();b.focus(!0),c.removeAllRanges(),c.addRange(a),b.refreshCommands()},paste:function(a){var b,c,d,e,f=this,g=f.getDoc(),h=f.getRange();for(f.focus(!0),h.deleteContents(),b=g.createElement("div"),b.innerHTML=a,c=g.createDocumentFragment();d=b.firstChild;)e=c.appendChild(d);h.insertNode(c),f._syncValue(),f.refreshCommands()},update:function(){this._syncValue()},_initEvents:function(b){var c=this,d=c._eventNS,e=B.ie;w(b)||(b=c._inline?c.element:e?c.getWin():c.getDoc()),e&&(c.getDoc().body.onbeforedeactivate=null),a(b).off(d).on(D+d,r(c._focus,c)).on(F+d,r(c._click,c)).on(H+d,r(c._keydown,c)).on(G+d,r(c._keyup,c)),e?c.getDoc().body.onbeforedeactivate=r(c._blur,c):a(b).on(E+d,r(c._blur,c))},_getIframeStyles:function(){return"<style>html,body{margin:0;padding:2px;}p{margin:0 0 0.5em 0;}</style>"},_getIframeScripts:function(){var a=this.options.domain;return a?'<script type="text/javascript">document.domain="'+a+'";</script>':""},value:function(){var b,c,d,e=this,f=[].slice.call(arguments),g=e._inline,h=a(e._original);return f.length>0?(c=f[0],d=f[1],g?a(e.element).html(c):(b=e.getDoc(),b.open().write('<head><meta charset="utf-8">'+e._getIframeStyles()+e._getIframeScripts()+'</head><body contenteditable="true" autocorrect="off">'+c+"</body>"),b.close(),e.element=e.getDoc().body,e._initEvents(b),d||e._syncValue(c)),void 0):g?h.html():a(e.getDoc().body).html()},hide:function(){a(this._getWrapper()).hide()},show:function(){a(this._getWrapper()).show()},isVisible:function(){return a(this._getWrapper()).is(":visible")},enabled:function(){var b,c=this,d=[].slice.call(arguments);return d.length>0?(b=!!d[0],b?a(c._getWrapper()).removeAttr(C).removeClass("sui-editor-disabled"):a(c._getWrapper()).attr(C,C).addClass("sui-editor-disabled"),c._enabled=b,void 0):c._enabled},destroy:function(){var b,c=this,e=c.options,f=e.cls,g=c._original,h=c._eventNS;if(a(c.element).off(h),a(q).off(h),c._toolbar){if(c._commands){for(b=0;b<c._commands.length;b++)c._commands[b].destroy();c._commands=d}a(c._toolbar).off(h).remove(),c._toolbar=d}c._inline?a(g).removeAttr("autocorrect").prop("contentEditable","off").removeClass(O+" "+O+"-inline"+(f?" "+f:"")):(a(c._iframe).remove(),a(g).unwrap(),a(g).show()),c._inline=c._iframe=c._wrapper=c._toolbarMoved=c._savedSelections=d,o.fn.destroy.call(c)}}),n.defaults=m,b.ui.plugin("Editor",n)}(jQuery,shield,this);